Ниже будут даны ответы на вопросы:

* Какие пункты плана были выполнены, а какие — нет. Почему?
* Какие трудности возникли и как вы их преодолели?
* Какие ключевые шаги в решении задачи вы выделили?
* Какая ваша итоговая модель, какие у неё гиперпараметы и какое качество?
* Список признаков, используемых для обучения лучшей модели и описание их предобработки
* Рекомендации по улучшению модели, решения

**Какие пункты плана были выполнены, а какие — нет. Почему?** 

Ниже представлен план проекта с необходимыми комментариями

## План проекта

| Пункт плана                                                  | Выполнено? | Комментарий                               |
|--------------------------------------------------------------|------------|-------------------------------------------|
|**1. Проведение обзора данных (EDA)**                         | ||
|**Подготовка и анализ исходных данных:**                      | |
| Импорт необходимых библиотек                                 |✓|
| Загрузка данных|✓|Загрузка выполнена через try-except для запуска с разными источниками|
| Получение общей информации о таблицах (head, info, describe)|✓||
| Корректировка наименований столбцов (при необходимости)|X|Названия столбцов не содержат неверных обозначений. Приведение к Snake case не производилось из-за однородности всех названий по всем таблицам|
| Графическое представление данных из таблиц|✓|Приведены гистограммы по всем столбцам с рассмотрением аномалий и характеров распределений|
| Проверка данных на аномалии|✓|Произведена проверка, найдены аномально низкие значения температур (ок. 1200) и отрицательной реактивной мощности. Позже по согласованию Заказчиком, эти аномалии удалены|
| Выводы|✓|Приведены выводы и вопросы для консультации с Заказчиком|
|**Предобработка данных:**| |
| Корректировка типов данных (при необходимости)|✓| Выполнены преобразования типа object на datetime во всех таблицах|
| Заполнение пропусков|✓| В данных по материалам Nan заменены на 0|
| Удаление дубликатов (при наличии)| X| Совершена проверка на явные дубликаты и качественная оценка наличия неявных дубликатов. Дубликатов не обнаружено|
| Удаление выбросов | ✓| Удалены согласованные Заказчиком выбросы|
| Выделение признаков и таргета | ✓|Выделен таргет - конечная температура, добавлены признаки: полная мощность, длительность нагрева, длительность между замерами(суммарное время нахождения материала в ковше). Время добавления сыпучих и проволочных материалов не учитывается в модели. Также не учитываются в модели ковши только с одним измерением температуры|
| Соединение таблиц| ✓| Произведено объединение необходимых таблиц по номеру ковша|
| Выводы| ✓|Приведены выводы по итоговой таблице с данными|
| **Исследование итоговой таблицы с данными:**| |
| Аналитический анализ| ✓| Произведён анализ итоговых данных на пропуски, выбросы, средние значения и экстремумы.|
| Графический анализ| ✓|Произведён анализ гистограмм распределений итоговых данных, а также рассмотрены зависимости Конечная температура - Начальная температура, Конечная температура - длительность нагрева|
| Корреляционный анализ|✓ |Произведён анализ на мультиколлинеарность и отброшены признаки, сильно коррелирующие друг сдругом (>0.9): активная, реактивная мощности, wire 5, bulk 9|
| Выводы| ✓|Основной вывод заключается в том, что описываемый технологический процесс - сложный, итерационный, и что для прогнозирования конечной температуры нужно большое количество данных (это есть) и внимательный подход к подготовке, анализу данных и создании моделей машинного обучения|
|**2. Построение модели машинного обучения**| |
|**Обучение модели:**| |
| Разделение данных на обучающую и тестовую выборки|✓ |Выполнено разделение на обучающую и тестовую выборки в соотношении 75:25|
| Масштабирование данных|✓ |Произведено масштабирование данных в силу их неоднородности|
| Обучение модели линейной регрессии| ✓|Обучена модель кросс-валидацией. Результат MAE на тренировочной выборке 5.96|
| Обучение модели случайного леса| ✓|Обучена модель с кросс-валидацией. Результат MAE на тренировочной выборке 6.11|
| Обучение модели градиентного бустинга lightgbm| ✓|Обучена модель с кросс-валидацией и перебором гиперпараметров. Результат MAE на тренировочной выборке 6.2|
| Обучение модели градиентного бустинга catboost| ✓|Обучена модель с кросс-валидацией и перебором гиперпараметров. Результат MAE на тренировочной выборке 5.84|
| Константная модель|✓ |Выведена констатная модель по медиане. Результат MAE на тренировочной выборке 8.00| 
| Выбор лучшей модели|✓ | Выбрана лучшая модель с лучшими гипер-параметрами - градиентный бустинг CatBoost|
|**Проверка моделей:**| |
| Тестирование лучшей модели на тестовой выборке| ✓| CatBoost показала результат MAE=5.68|
| Если MAE на тестовых данных > 6.8 - доработка модели| X|В этом необходимости не было|
| Анализ важности факторов| ✓| Интересное наблюдение: наиболее важные факторы: длительность нагрева, начальная температура, длительность между замерами. При этом траты электроэнергии как фактор для модели находятся в середине и имеют вес в 3%"|
|**3. Общий вывод**||

**Какие трудности возникли и как вы их преодолели?** 

Основная трудность была в постановке задачи и выборе целевой. Решено было перебором вариантов и консультацией с тимлидом. 

Также было узкое место по выбору параметров features: основываясь на логику и примерное понимание сути моделируемого физического процесса надо было добавить дополнительные параметры, которые в итоге улучшили качество предсказаний.

**Какие ключевые шаги в решении задачи вы выделили?** 

Наиболее точно см. план, но в целом ключевые шаги выделены следующие:

* Рассмотрены исходные данные с целью ознакомления и проверка на наличие аномалий, выбросов;
* Проивзедён опрос Заказчика по уточнению целей, задач и нюансов в распознавании данных;
* Произведена предобработка данных с целью дальнейшего наилучшего подбора модели;
* Произведено объединение данных из различных таблиц;
* Произведён анализ очищенных данных, исследованы корреляции признаков;
* Разделены признаки на тренировочные и целевой (при необходимости добавлены новые признаки);
* Разделены выборки на тренировочную и тестовую;
* Произведён подбор нескольких моделей машинного обучения с перебором гиперпараметров на кросс-валидации;
* Отобрана лучшая модель на кросс-валидации по параметрам качества предсказаний;
* Проверена лучшая модель на тестовой выборке;
* Составлен отчёт о проделанной работе и рекомендациях бизнесу по применению модели.

**Какая ваша итоговая модель, какие у неё гиперпараметы и какое качество?** 

* Итоговая модель - градиентный бустинг CatBoost.

* Гиперпараметры из тех, что перебирались инструментом GridSearchCV: 'iterations': 400, 'learning_rate': 0.05.

* Качество MAE на тестовой выборке: 5.68

* Random state = 280823

**Список признаков, используемых для обучения лучшей модели и описание их предобработки** 

|Признак|Предобработка|
|-------|-------------|
|Полная мощность|Выведена из активной и реактивной мощностей. В реактивной мощности был удалён выброс - отрицательное значение, в сотни раз больше среднего|
|Длительность нагрева|Выведена из таблицы с электрическими мощностями как разность окончания нагрева последней итерации и начала нагрева начальной для каждого ковша|
|Bulk 1...Bulk 8, Bulk 10...Bulk 15|Заполнены пропуски: заменены NaN на 0|
|Газ 1|Предобработка не производилас|
|Начальная температура|Выведена из таблицы с замерами температур для каждого ковша|
|Длительность между замерами|Выведена из таблицы с замперами температур по каждому ковшу как разность между последним замером и первым|
|Wire 1...Wire 4, Wire 6...Wire 9|Заполнены пропуски: заменены NaN на 0|

**Рекомендации по улучшению модели, решения** 

Основные рекомендации по улучшению модели:

Можно добавить побольше признаков, например: 
* выход температуры за некоторое пороговоре значение. 1- вышел, 0 - нет. Смотрим на те температуры, что вышли и проводим как анализ данных, что могло привести к этому, так и включаем в модель и по ходу реального процесса в дальнейшем говорим оператору: ты рискуешь перегреть ковш через 3 итерации и растратить кучу денег, отнесись к ним внимательно;
* добавить в модель как признак время добавления материалов от начала процесса: тогда возможно и показания будут точнее, и модель сможет предсказывать если какую-то важную примесь положили не столько сколько нужно было
* добавить в модель какую-то экономику, стоимость электроэнергии: тогда в процессе производства будет прогностически видно, сколько стоит данный ковш и, возможно, как-то повлиять на технологию, или вообще отменить и отправить его в переработку, если процесс стал вдруг нерентабелен 
* добавить номера смен/время суток в качестве признака - маловероятно, но может и помочь увеличить точность и обратить внимание персонала на то, как он выполняет свои обязанности

Для решения в целом, есть основное наверное требование: совместить нашу модель с другими, которые учитывают **химический состав на входе и выходе например**. 

Также можно исследовать энергоэффективность производственного процесса по вторичным признакам, например (сейчас, не зная специфики точно, могу ошибаться, но если сравнивать с иными производствами, то может и сработать):
* исторические данные об авариях, можно определить пороги в технологическом процессе, которые нельзя переходить, и предсказывать потенциальное приближение к таковым через несколько итераций;
* вибрация основных механизмов
* нагрев изоляции, наиболее слабых мест технологической установки
* если есть какое-то регулярно меняемое оборудование или материалы - дата их замены (изоляция или например подшипники насоса или что-то такое)
* условия труда на рабочих местах (может влиять скорее не на качество металла, а на прочие расходы Предприятия на охрану труда, страховки, менеджмент качества и сторонний аудит)

